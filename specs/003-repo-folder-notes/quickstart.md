# Quickstart: 仓库内目录与笔记管理（开发验证）

本文件用于开发者在实现完成后快速验证“目录管理 + 笔记管理”在 macOS/iOS 两端语义一致、且性能指标可观测。

## 1) 打开工程

- 打开 `QingJianApp/QingJian.xcworkspace`
- 选择目标：`QingJianMac` 或 `QingJianIOS`

## 2) 运行共享核心测试

- 运行 `QingJianCoreTests`
  - 重点关注：`OrderingMergeRulesTests`（排序/合并规则）、Repo/Storage 相关测试

## 3) 手工验收（建议使用 fixtures）

使用仓库自带示例仓库：
- `QingJianApp/Tests/Fixtures/SampleRepo/`

建议验收路径（两端应一致）：
- **P1**：选中仓库 → 在根目录新建笔记 → 打开笔记 → 返回后仍可找到并打开
- **P2**：创建目录 → 重命名目录 → 将目录移动到另一个目录下 → 删除非空目录（确认提示正确）
- **P3**：重命名笔记 → 移动笔记到其他目录 → 删除笔记（确认提示正确）
- **边界**：重名冲突、移动到自身/子目录、仓库不可用、未保存更改保护

## 4) 性能观测（Debug）

在 Debug 环境下观察 `PerfMetrics` 输出，至少覆盖：
- `repo.scan`
- `note.open`
- `note.save`
- `editor.key_latency` / `preview.update`（如平台实现包含编辑预览）

## 5) 双端验收清单（T036）

### macOS 验收

| # | 场景 | 预期结果 | 通过 |
|---|------|---------|------|
| 1 | 选中仓库后点击「新建笔记」 | 弹出新建笔记对话框，可输入名称和选择目录 | ☐ |
| 2 | 创建笔记后 | 笔记出现在目录树中，可点击打开 | ☐ |
| 3 | 右键目录 → 新建子目录 | 弹出输入框，目录创建成功 | ☐ |
| 4 | 右键目录 → 重命名 | 弹出输入框，重命名成功 | ☐ |
| 5 | 右键目录 → 删除（非空） | 显示确认对话框，确认后删除成功 | ☐ |
| 6 | 右键笔记 → 重命名 | 弹出输入框，重命名成功 | ☐ |
| 7 | 右键笔记 → 删除 | 删除成功，从列表消失 | ☐ |
| 8 | 创建同名笔记/目录 | 显示错误提示（已存在） | ☐ |
| 9 | 移动目录到自身子目录 | 显示错误提示（非法操作） | ☐ |

### iOS 验收

| # | 场景 | 预期结果 | 通过 |
|---|------|---------|------|
| 1 | 进入仓库后点击「+」新建笔记 | 弹出新建笔记界面，可输入名称 | ☐ |
| 2 | 创建笔记后 | 笔记出现在列表中，可点击查看 | ☐ |
| 3 | 左滑目录 → 删除 | 显示确认对话框，确认后删除成功 | ☐ |
| 4 | 左滑笔记 → 删除 | 显示确认对话框，确认后删除成功 | ☐ |
| 5 | 刷新列表（下拉） | 列表内容更新 | ☐ |
| 6 | 空仓库显示 | 显示空状态提示 | ☐ |

### 跨端一致性

| 项目 | macOS | iOS | 一致 |
|------|-------|-----|------|
| 术语：目录/笔记 | ☐ | ☐ | ☐ |
| 删除确认流程 | ☐ | ☐ | ☐ |
| 错误提示文案 | ☐ | ☐ | ☐ |
| 性能埋点输出 | ☐ | ☐ | ☐ |


