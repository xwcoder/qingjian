# Errors Contract: 打开已有仓库（添加已有仓库）

本文件补充与“新建/打开仓库”相关的错误语义，确保 macOS+iOS 表达一致（宪法要求）。

原则：
- 错误必须表达“原因 + 下一步动作”
- 复用 `CoreError` 现有分类，避免新增不必要概念

---

## Error Types（增量补充）

### InvalidRepo（仓库不可打开/不可新建）

**Meaning**:
- 选择的路径不是目录、不可读写、或不满足对应入口的仓库要求

**Specific cases**（通过 message/reason 区分语义）:
- 打开仓库：缺失 `.qingjian_metadata.json` → “缺少仓库元信息，无法打开”
- 打开仓库：元信息无法解析 → “仓库信息损坏/不完整，无法打开”
- 新建仓库：目录不可写 → “没有写入权限，无法初始化仓库”

**User action**:
- 重新选择目录
- 或改用另一个入口（例如：目录无元信息时可用“新建仓库”初始化）

### AlreadyAdded（重复添加）

**Meaning**: 同一路径/同一仓库标识已在仓库列表中

**User action**:
- 直接打开已有条目（UI 应定位到该条目）

### RepoUnavailable（已添加但不可用）

**Meaning**: 仓库曾经添加成功，但路径/授权失效导致当前不可访问

**User action**:
- 重新定位/重新授权
- 或从列表移除


